pt6 
Autocorrelation and partial autocorrelation functions
Presentation
In this class, we will present the dependency structures of time series models, called autocorrelation function and partial autocorrelation function. Then, these functions will be calculated for each of the theoretical time series models of the ARMA class defined in the previous chapters, defining characteristic patterns of each model.

Goals
Examine the concepts of autocorrelation function (FAC) and partial autocorrelation function (FACP);
Analyze theoretical FAC patterns for each model of the ARMA class;
Identify theoretical FACP patterns for each model of the ARMA class.
6.1 - Autocovariance Function
We saw in class 3 that a (weakly) stationary model satisfies the following properties:
E(Yt) = Î¼, âˆ€t = 1,2,...,T (constant mean)V(Yt) = Î´2, âˆ€t = 1,2,...,T(constant variance)Cov(Yt, Yt-k) = Î³k (Cov is a function of k only!) âˆ€ t = 1,2,...,T
In particular, covariance is constant over time, but varies with k. This means that Cov(Y3,Y2) = Cov(Y2,Y1) (both denoted by Î³1) but, for example, Cov(Y3,Y1) â‰ Cov(Y2,Y1).

 In this case (that is, if the model is stationary), Î³k = Cov(Yt,Yt-k) is called the Autocovariance Function (FACV) of Yt, set to k = 0, 1, 2... (the name has the same justification for the case of an autoregressive model: It basically represents the covariance of the series with itself, lagged). Note also that: Î³0 = Cov(Yt,Yt) = V(Yt), that is, it is the variance of the series.

Each k value that we set Î³k to is called a lag, or lag. This term is quite common in time series literature. It will be frequent, therefore, to refer to Î³k as an autocovariance function of lag k.

We've set aside some examples for you.

Example 6.1 - Let a model A be such that: Cov(Yt,Yt-k) = (2t)k and a model B such that Cov(Yt,Yt-k) = (1/2)k+1. Which of these models has a valid autocovariance function and what is its value at lag 2?

Solution: Model B, in which Cov(Yt,Yt-k) does not depend on t. For this case,Î³ 2 = (1/2)3 = 0.125.
6.2 - Autocorrelation Function
The correlation between two random variables X and Y is defined as follows:
ÏXY=CorrX,Y=CovX,YVXVY.
Thus, it is immediate to define the autocorrelation function of a time series as follows:

Ïk=CorrYt,Ytâˆ’k=CovYt,Ytâˆ’kVYtVYtâˆ’k
Since the model is stationary (remember that this is a premise for the autocovariance function - and therefore also the autocorrelation function - to be valid), we have that V(Yt ) = V(Yt-k), and so on :

Ïk=Cov(Yt,Ytâˆ’k)V(Yt)V(Yt)=Cov(Yt,Ytâˆ’k)V(Yt)=Î³kÎ³0.
The FAC, like the FACV, is also defined for lags k = 0, 1, 2..., where p0 = 1.

Let's see some more examples?

Example 6.2 - Obtain the lag k autocorrelation function for the model in the previous example.


Solution: Î³0 = (1/2)0+1 = (1/2)1 = 1/2. Thus, Ïk = (1/2)k+1/1/2 = (1/2)k.

Example 6.3 - Check that the autocovariance function satisfies the following properties: Î³-k=Î³k; kâ‰¤Î³0.
Solution: By the covariance property: Cov(X,Y) = Cov(Y,X), we have that: ï§k = Cov(Yt,Yt-k) = Cov(Yt-k,Yt) = Î³-k. Finally, consider the correlation property: | k| â‰¤1. Since Î³ k = Î³k/ Î³ 0, we have that: |AAAk/Î³0| Â£1, and so: |ï²k| ï² |Î³0|, but since ï²0 is the variance: |ï²0| = ï² and |ï²k| ï²|Î³0|.

6.3 - FACV and FAC for the AR model
Starting with AR(1), first remembering the model equation:
Yt =Î¦0+ Î¦1Ytâˆ’1+Îµt.
The FACV of the AR(1) is:

Yt=CovYt,Ytâˆ’1=Cov (Î¦1+Ytâˆ’1+Îµt,Ytâˆ’1).
Using the covariance property: Cov(X+Y+W,Z) = Cov(X,Z) + Cov(Y,Z) + Cov(W,Z), we have:

CovÏ•0+Ï•1Ytâˆ’1+Îµt,Ytâˆ’1=Ï•1CovYtâˆ’1,Ytâˆ’1=Ï•1VYtâˆ’1=Ï•1 V(Yt )=Ï•1 Î³0.
Thus, for the AR(1) model, the FACV at lag 1 is: Î³1=Cov(Yt,Yt-1) = Ï•1 Î³0.

Calculating now for lag 2:

Î³2=CovYt,Ytâˆ’2=
CovÏ•0+Ï•1Ytâˆ’1+Îµt,Ytâˆ’2
=Ï•1CovYtâˆ’1,Ytâˆ’2=Ï•Î³1=Ï•12Î³0.
Î³3=CovYt,Ytâˆ’3=
CovÏ•0+Ï•1Ytâˆ’1+Îµt,Ytâˆ’3
=Ï•1Cov(Ytâˆ’1,Ytâˆ’3)=Ï•1Î³2=Ï•13Î³0.
Thus, for the AR(1) model, the FACV at lag 1 is: Î³1=Cov(Yt,Yt-1) = Ï•1 Î³0.

 

Calculating now for lag 2:

 

And so on, until we get to the general formula:

Î³k=Ï•1Î³kâˆ’1=Ï•1kÎ³0.
But Î³0=VYt=Ïƒ21âˆ’Ï•12 , as we saw in class 5, and so the FACV of the AR(1) model is:
Î³k=Ï•1k1âˆ’Ï•12Ïƒ2, k = 0, 1, 2...
The FAC of the AR(1) is:

Ïk=Î³kÎ³0=Ï•1k, k = 1, 2...
The FAC of an AR(1) model has an exponential decay if Ï•1>0, and is a damped sinusoid if Ï•1<0. See some examples.

Example 6.4 - Theoretical FAC of an AR(1) model with Ï•1^ = 0.8 is presented below:
The FAC of an AR(p) model also has this pattern.

6.4 - FACV and FAC for the MA model
Click the button above.
Starting with MA(1), first remembering the model equation: Yt = Îµt - Î¸1Îµt-1.

The FACV of the MA(1) is:

Î³1=Cov(Yt,Ytâˆ’1)=
CovÎµtâˆ’Î¸1Îµtâˆ’1,Îµtâˆ’1âˆ’Î¸1Îµtâˆ’2=
âˆ’Î¸1CovÎµtâˆ’1,Îµtâˆ’1=âˆ’Î¸1VÎµtâˆ’1
=âˆ’Î¸1VÎµt=âˆ’Î¸1Ïƒ2.
Î³2=Cov(Yt,Ytâˆ’2)=
CovÎµtâˆ’Î¸1Îµtâˆ’1,Îµtâˆ’2âˆ’Î¸1Îµtâˆ’3=0.
Î³3=Cov(Yt,Ytâˆ’2)=
Cov(Îµtâˆ’Î¸1Îµtâˆ’1,Îµtâˆ’3âˆ’Î¸1Îµtâˆ’4)=0.
And so on. It is easy to see that Î³k=0, , k = 2, 3..., since Cov(Îµt,Îµt-k)=0 for all kâ‰ 0.

Thus, the FACV of the MA(1) is:

Î³k=âˆ’Î¸1Ïƒ2, k=1.
=0.k=2.3...
where the conclusion for k = 2, 3... comes from the fact that white noise is uncorrelated.

To get the FAC, we need to remember that ğ›¾0=VYt=(1+ğœƒ12)ğœ2, as we saw in lesson 5.

 "So the FACV of the model "the MA(1) is:

Ï1=Î³1Î³0=âˆ’Î¸1Ïƒ2(1+Î¸12)Ïƒ2=âˆ’Î¸1(1+Î¸12).
Ïk=0, k=2,3, ...

Thus, the FAC of MA(1) is finite. We say it is â€œtruncatedâ€ at lag 1.

Example 6.6 - Theoretical FAC of a MA(1) model with ğœƒ_1= 0.6 is presented below:
Example 6.7 - The theoretical FAC of a MA(1) model with ğœƒ1>=-0.9 is shown below:
Let's now calculate the FACV of the MA(2). Remembering the model equation:

Yt=Îµt-Î¸1Îµt-1-Î¸2Îµt-2.
The FACV is calculated below. Starting with lag 1:

Î³1=Cov(Yt,Ytâˆ’1)=
CovÎµtâˆ’Î¸1Îµtâˆ’1âˆ’Î¸2Îµtâˆ’2,Îµtâˆ’1âˆ’Î¸1Îµtâˆ’2âˆ’Î¸2Îµtâˆ’3=
âˆ’Î¸1CovÎµtâˆ’1,Îµtâˆ’1+Î¸1Î¸2CovÎµtâˆ’2,Îµtâˆ’2=
=(âˆ’Î¸1Î¸2âˆ’Î¸1) Ïƒ2.
At lag 2:

Î³2=Cov(Yt,Ytâˆ’2)=
CovÎµtâˆ’Î¸1Îµtâˆ’1âˆ’Î¸2Îµtâˆ’2,Îµtâˆ’2âˆ’Î¸1Îµtâˆ’3âˆ’Î¸2Îµtâˆ’4=
âˆ’Î¸2Cov(Îµtâˆ’2,Îµtâˆ’2)=âˆ’Î¸2Ïƒ2.
It's easy to see that Î³0=0 for k =3.4...

Thus, the FACV of the MA(2) is:

Î³k=Î¸1Î¸2âˆ’1,k=1
=âˆ’Î¸2, k=2
=0.k=3.4,...
To obtain the FAC, it is necessary to remember that, in the case of the MA(2), we have from class 5 that:

Î³0=VYt=(1+Î¸12+Î¸22)Ïƒ2.
Thus, the FAC of the MA(2) is (the Ïƒ2 in the numerator and denominator is canceled):

Ïk=Î¸1Î¸2âˆ’11+Î¸12+Î¸22, k=1
=âˆ’Î¸21+Î¸12+Î¸22, k=2
=0, k=3, 4, â€¦

So we have that the MA(2) FAC is truncated at lag 2.

Example 6.8 - Theoretical FAC of an MA(2) model is presented below:
This result can be generalized to an MA(q) model: the FAC of an MA(q) is â€œtruncatedâ€ at lag q, for any q = 1, 2, 3, ...

6.5 - The partial autocorrelation function
The FACP Partial Autocorrelation Function is the partial correlation between Yt and Yt-k, that is, it is the correlation between Yt and Yt-k, after discounting the influence of Yt-1, Yt-2, ..., Yt -k+1.

Notation: Ï•kk.

Obs1 âˆ’ by definition: ï†11 = ï²1.
Obs2 âˆ’ in the AR(p) model, ï†pp =Ï•p.
In the MA(q) model, the FACP behaves like the FAC of an AR model (exponential decay or damped sinusoid).

 
Example 6.9 - The theoretical FACP of an MA(1) model is presented below:
Note that the pattern of the FACP for the AR (truncation in lag p) is analogous to what happened with the FAC of MA(q), in this case, in lag q. These results will be used for identification in class 7.

Example 6.11 - Theoretical FACP of an AR(1) model with Ï•1=0.5 is shown below:

Example 6.12 - Theoretical FACP of an AR(2) model is presented below:

It can be noted that, in the latter case, the FACP is â€œtruncatedâ€ at lag 2.

 Note also that, in example 6.11, the FACP is â€œtruncatedâ€ at lag 1. The difference is only in the sign of the FACP at lag 1, which is positive.

 It is noteworthy that, in the case of FAC, however, there is also a difference in the decay structure, which would be exponential in the first case and of the damped sinusoid type, in the second case.

 
Finally, if we have an ARMA(p,q) model, with p and q different from zero, we will observe a mixture of the patterns studied in this class.

The table below summarizes the FAC and FACP standards expected for the theoretical models.

In class 7 we will see the application of these results to the modeling of a real series, in particular, to the identification of the p and q orders of the adequate model to represent the series.

Activities
1 - Consider the model:
Yt=Îµt-0.5Îµt-1

The FAC value at lag 1 is:

a) 0
b) 0.2
c) 0.4
d) 0.5
e) Lack of information to determine.
Ã§. -
0.5/(1+0.52) = 0.5/1.25 = 0.4.

2 - One model presents the following theoretical FACP.
Its FAC is known to have an exponential decay. The corresponding model is a:

a) AR(1)
b) AR(2)
c) MA(1)
d) MA(2)
e) WEAPON(1,1)


Option b -
An AR(p) model has FACP truncated at lag p. The FACP is truncated at lag 2, standard for an AR(2) model.
Regarding the ARIMA models by Box and Jenkins, tick the correct statement:

a) Let the AR(1):Yt=Ï•Yt-1+Îµt model be stationary. The autocovariance function of this model is: ğœ‘k(1âˆ’ğœ‘)2ğœ2, k = 0, 1, 2, ...
b) The autocorrelation function (FAC) of an AR(p) model is truncated at lag p.
c) The partial autocorrelation function (FACP) of a MA(q) model is truncated at lag q.
d) The AR(2):Yt=Ï•Yt-1+Ï•2Yt-2 +Îµt,Îµt~NID(0,Ïƒ2) model is stationary if, and only if, |Ï•1|<1 and |Ï•2|<1, but it is invertible for any values â€‹â€‹of Ï•1 and Ï•2.
e) Let the model be: Yt=Ï•Yt-1+Îµt -Î¸Îµt-1, Îµt~NID(0,Ïƒ2). This model is invertible if and only if Î¸<1 , and is stationary if and only if Î¸<1 ,


Option e - The alternative is the only correct one, presenting the stationarity and invertibility conditions of the ARMA(1,1) model.
